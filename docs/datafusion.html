<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Data Fusion and Assimilation | A Minimal Introduction to Ecological Forecasting and Reproducible Research</title>
  <meta name="description" content="This is a minimal introduction to Ecological Forecasting and Reproducible Research for the 3rd year undergraduate Biological Sciences BIO3019S class at the University of Cape Town." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Data Fusion and Assimilation | A Minimal Introduction to Ecological Forecasting and Reproducible Research" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal introduction to Ecological Forecasting and Reproducible Research for the 3rd year undergraduate Biological Sciences BIO3019S class at the University of Cape Town." />
  <meta name="github-repo" content="jslingsby/BIO3019S_Ecoforecasting" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Data Fusion and Assimilation | A Minimal Introduction to Ecological Forecasting and Reproducible Research" />
  
  <meta name="twitter:description" content="This is a minimal introduction to Ecological Forecasting and Reproducible Research for the 3rd year undergraduate Biological Sciences BIO3019S class at the University of Cape Town." />
  

<meta name="author" content="Jasper Slingsby" />


<meta name="date" content="2021-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Introduction to Ecological Forecasting and Reproducible Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#general"><i class="fa fa-check"></i><b>1.1</b> General</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#lectures-and-practicals"><i class="fa fa-check"></i><b>1.2</b> Lectures and practicals</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preparation"><i class="fa fa-check"></i><b>1.3</b> Preparation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#a-bit-about-me"><i class="fa fa-check"></i><b>1.4</b> A bit about me</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#acknowledgements-and-further-reading"><i class="fa fa-check"></i><b>1.5</b> Acknowledgements and further reading:</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pracprep.html"><a href="pracprep.html"><i class="fa fa-check"></i><b>2</b> Preparation for the practical</a></li>
<li class="chapter" data-level="3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>3</b> Models and decision making</a>
<ul>
<li class="chapter" data-level="3.1" data-path="models.html"><a href="models.html#the-basics-of-making-a-decision"><i class="fa fa-check"></i><b>3.1</b> The basics of making a decision</a></li>
<li class="chapter" data-level="3.2" data-path="models.html"><a href="models.html#getting-quantitative"><i class="fa fa-check"></i><b>3.2</b> Getting quantitative</a></li>
<li class="chapter" data-level="3.3" data-path="models.html"><a href="models.html#iterative-decision-making"><i class="fa fa-check"></i><b>3.3</b> Iterative decision-making</a></li>
<li class="chapter" data-level="3.4" data-path="models.html"><a href="models.html#iterative-decision-making-and-the-scientific-method"><i class="fa fa-check"></i><b>3.4</b> Iterative decision-making and the scientific method</a></li>
<li class="chapter" data-level="3.5" data-path="models.html"><a href="models.html#the-importance-of-prediction-in-ecology"><i class="fa fa-check"></i><b>3.5</b> The importance of prediction in ecology</a></li>
<li class="chapter" data-level="3.6" data-path="models.html"><a href="models.html#iterative-near-term-ecological-forecasting"><i class="fa fa-check"></i><b>3.6</b> Iterative near-term ecological forecasting</a></li>
<li class="chapter" data-level="3.7" data-path="models.html"><a href="models.html#iterative-ecological-forecasting-in-context"><i class="fa fa-check"></i><b>3.7</b> Iterative ecological forecasting in context</a></li>
<li class="chapter" data-level="3.8" data-path="models.html"><a href="models.html#reproducible-research"><i class="fa fa-check"></i><b>3.8</b> Reproducible research</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="forecasts.html"><a href="forecasts.html"><i class="fa fa-check"></i><b>4</b> Making forecasts</a>
<ul>
<li class="chapter" data-level="4.1" data-path="forecasts.html"><a href="forecasts.html#proteaceae-as-a-model-organisms"><i class="fa fa-check"></i><b>4.1</b> Proteaceae as a model organisms</a></li>
<li class="chapter" data-level="4.2" data-path="forecasts.html"><a href="forecasts.html#proteaceae-as-management-indicators"><i class="fa fa-check"></i><b>4.2</b> Proteaceae as management indicators</a></li>
<li class="chapter" data-level="4.3" data-path="forecasts.html"><a href="forecasts.html#potential-issues-with-the-rules-of-thumb"><i class="fa fa-check"></i><b>4.3</b> Potential issues with the rules of thumb…</a></li>
<li class="chapter" data-level="4.4" data-path="forecasts.html"><a href="forecasts.html#assessing-population-viability"><i class="fa fa-check"></i><b>4.4</b> Assessing population viability</a></li>
<li class="chapter" data-level="4.5" data-path="forecasts.html"><a href="forecasts.html#climate-and-fire-driven-changes-in-demographic-rates-and-distribution"><i class="fa fa-check"></i><b>4.5</b> Climate and fire-driven changes in demographic rates and distribution</a></li>
<li class="chapter" data-level="4.6" data-path="forecasts.html"><a href="forecasts.html#near-term-iterative-ecological-forecasts"><i class="fa fa-check"></i><b>4.6</b> Near-term iterative ecological forecasts?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reproducibility.html"><a href="reproducibility.html"><i class="fa fa-check"></i><b>5</b> Reproducible research</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reproducibility.html"><a href="reproducibility.html#the-reproducibility-crisis"><i class="fa fa-check"></i><b>5.1</b> The Reproducibility Crisis</a></li>
<li class="chapter" data-level="5.2" data-path="reproducibility.html"><a href="reproducibility.html#replication-and-the-reproducibility-spectrum"><i class="fa fa-check"></i><b>5.2</b> Replication and the Reproducibility Spectrum</a></li>
<li class="chapter" data-level="5.3" data-path="reproducibility.html"><a href="reproducibility.html#why-work-reproducibly"><i class="fa fa-check"></i><b>5.3</b> Why work reproducibly?</a></li>
<li class="chapter" data-level="5.4" data-path="reproducibility.html"><a href="reproducibility.html#barriers-to-working-reproducibly"><i class="fa fa-check"></i><b>5.4</b> Barriers to working reproducibly</a></li>
<li class="chapter" data-level="5.5" data-path="reproducibility.html"><a href="reproducibility.html#reproducible-scientific-workflows"><i class="fa fa-check"></i><b>5.5</b> Reproducible Scientific Workflows</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="reproducibility.html"><a href="reproducibility.html#file-and-folder-management"><i class="fa fa-check"></i><b>5.5.1</b> File and folder management</a></li>
<li class="chapter" data-level="5.5.2" data-path="reproducibility.html"><a href="reproducibility.html#coding-and-code-management"><i class="fa fa-check"></i><b>5.5.2</b> Coding and code management</a></li>
<li class="chapter" data-level="5.5.3" data-path="reproducibility.html"><a href="reproducibility.html#computing-environment-and-software"><i class="fa fa-check"></i><b>5.5.3</b> Computing environment and software</a></li>
<li class="chapter" data-level="5.5.4" data-path="reproducibility.html"><a href="reproducibility.html#sharing-of-the-data-code-publication-etc"><i class="fa fa-check"></i><b>5.5.4</b> Sharing of the data, code, publication etc</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="practical.html"><a href="practical.html"><i class="fa fa-check"></i><b>6</b> Practical: Pair coding with GitHub</a>
<ul>
<li class="chapter" data-level="6.1" data-path="practical.html"><a href="practical.html#objectives"><i class="fa fa-check"></i><b>6.1</b> Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="practical.html"><a href="practical.html#postfire-regeneration"><i class="fa fa-check"></i><b>6.2</b> Postfire regeneration</a></li>
<li class="chapter" data-level="6.3" data-path="practical.html"><a href="practical.html#modular-design"><i class="fa fa-check"></i><b>6.3</b> Modular Design</a></li>
<li class="chapter" data-level="6.4" data-path="practical.html"><a href="practical.html#task-1-create-clone-repository"><i class="fa fa-check"></i><b>6.4</b> Task 1: Create &amp; Clone Repository</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="practical.html"><a href="practical.html#owner"><i class="fa fa-check"></i><b>6.4.1</b> OWNER</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="practical.html"><a href="practical.html#task-2-add-the-first-function-download.ndvi"><i class="fa fa-check"></i><b>6.5</b> Task 2: Add the first function: download.NDVI</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="practical.html"><a href="practical.html#owner-1"><i class="fa fa-check"></i><b>6.5.1</b> OWNER</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="practical.html"><a href="practical.html#task-3-collaborator-adds-plot.ndvi"><i class="fa fa-check"></i><b>6.6</b> Task 3: Collaborator adds plot.NDVI</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="practical.html"><a href="practical.html#collaborator"><i class="fa fa-check"></i><b>6.6.1</b> COLLABORATOR</a></li>
<li class="chapter" data-level="6.6.2" data-path="practical.html"><a href="practical.html#owner-2"><i class="fa fa-check"></i><b>6.6.2</b> OWNER</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="practical.html"><a href="practical.html#task-4-owner-adds-functions-for-model-fitting-using-mle"><i class="fa fa-check"></i><b>6.7</b> Task 4: Owner adds functions for model fitting using MLE</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="practical.html"><a href="practical.html#owner-3"><i class="fa fa-check"></i><b>6.7.1</b> OWNER</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="practical.html"><a href="practical.html#task-5-collaborator-adds-the-master-script-owner-answers-the-questions"><i class="fa fa-check"></i><b>6.8</b> Task 5: Collaborator adds the master script, Owner answers the questions</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="practical.html"><a href="practical.html#collaborator-1"><i class="fa fa-check"></i><b>6.8.1</b> COLLABORATOR</a></li>
<li class="chapter" data-level="6.8.2" data-path="practical.html"><a href="practical.html#owner-4"><i class="fa fa-check"></i><b>6.8.2</b> OWNER</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="practical-output-master-script-for-postfire-analysis.html"><a href="practical-output-master-script-for-postfire-analysis.html"><i class="fa fa-check"></i><b>7</b> Practical output: Master script for postfire analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="practical-output-master-script-for-postfire-analysis.html"><a href="practical-output-master-script-for-postfire-analysis.html#source-functions-get-data-and-plot"><i class="fa fa-check"></i><b>7.1</b> Source functions, get data and plot</a></li>
<li class="chapter" data-level="7.2" data-path="practical-output-master-script-for-postfire-analysis.html"><a href="practical-output-master-script-for-postfire-analysis.html#fit-models-using-non-linear-least-squares-nls"><i class="fa fa-check"></i><b>7.2</b> Fit models using Non-linear Least Squares (NLS)</a></li>
<li class="chapter" data-level="7.3" data-path="practical-output-master-script-for-postfire-analysis.html"><a href="practical-output-master-script-for-postfire-analysis.html#compare-nls-models-using-anova"><i class="fa fa-check"></i><b>7.3</b> Compare NLS models using ANOVA</a></li>
<li class="chapter" data-level="7.4" data-path="practical-output-master-script-for-postfire-analysis.html"><a href="practical-output-master-script-for-postfire-analysis.html#fit-models-using-maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>7.4</b> Fit models using Maximum Likelihood Estimation (MLE)</a></li>
<li class="chapter" data-level="7.5" data-path="practical-output-master-script-for-postfire-analysis.html"><a href="practical-output-master-script-for-postfire-analysis.html#compare-mle-models-using-akaikes-information-criterion-aic"><i class="fa fa-check"></i><b>7.5</b> Compare MLE models using Akaike’s information criterion (AIC)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>8</b> Data Management</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data.html"><a href="data.html#why-do-you-need-to-manage-your-data"><i class="fa fa-check"></i><b>8.1</b> Why do you need to manage your data?</a></li>
<li class="chapter" data-level="8.2" data-path="data.html"><a href="data.html#the-data-life-cycle"><i class="fa fa-check"></i><b>8.2</b> The Data Life Cycle</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="data.html"><a href="data.html#plan"><i class="fa fa-check"></i><b>8.2.1</b> Plan</a></li>
<li class="chapter" data-level="8.2.2" data-path="data.html"><a href="data.html#collect-and-assure"><i class="fa fa-check"></i><b>8.2.2</b> Collect and Assure</a></li>
<li class="chapter" data-level="8.2.3" data-path="data.html"><a href="data.html#describe"><i class="fa fa-check"></i><b>8.2.3</b> Describe</a></li>
<li class="chapter" data-level="8.2.4" data-path="data.html"><a href="data.html#preserve"><i class="fa fa-check"></i><b>8.2.4</b> Preserve</a></li>
<li class="chapter" data-level="8.2.5" data-path="data.html"><a href="data.html#discover"><i class="fa fa-check"></i><b>8.2.5</b> Discover</a></li>
<li class="chapter" data-level="8.2.6" data-path="data.html"><a href="data.html#integrate"><i class="fa fa-check"></i><b>8.2.6</b> Integrate</a></li>
<li class="chapter" data-level="8.2.7" data-path="data.html"><a href="data.html#analyze"><i class="fa fa-check"></i><b>8.2.7</b> Analyze</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data.html"><a href="data.html#data-and-decisions"><i class="fa fa-check"></i><b>8.3</b> Data and decisions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>9</b> Going Bayesian</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bayesian.html"><a href="bayesian.html#least-squares"><i class="fa fa-check"></i><b>9.1</b> Least Squares</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="bayesian.html"><a href="bayesian.html#least-squares-analyses-dont-explicitly-include-a-data-model"><i class="fa fa-check"></i><b>9.1.1</b> Least Squares analyses don’t explicitly include a data model</a></li>
<li class="chapter" data-level="9.1.2" data-path="bayesian.html"><a href="bayesian.html#least-squares-focuses-on-what-the-parameters-are-not-rather-than-what-they-are"><i class="fa fa-check"></i><b>9.1.2</b> Least squares focuses on what the parameters are not, rather than what they are</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="bayesian.html"><a href="bayesian.html#maximum-likelihood"><i class="fa fa-check"></i><b>9.2</b> Maximum likelihood</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="bayesian.html"><a href="bayesian.html#joint-conditional-and-marginal-probabilities"><i class="fa fa-check"></i><b>9.2.1</b> Joint, conditional and marginal probabilities</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="bayesian.html"><a href="bayesian.html#bayes-theorem"><i class="fa fa-check"></i><b>9.3</b> Bayes’ Theorem</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="bayesian.html"><a href="bayesian.html#the-beauty-of-bayes-theorem"><i class="fa fa-check"></i><b>9.3.1</b> The beauty of Bayes’ Theorem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="datafusion.html"><a href="datafusion.html"><i class="fa fa-check"></i><b>10</b> Data Fusion and Assimilation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="datafusion.html"><a href="datafusion.html#a-quick-reminder-of-bayes-theorem-and-the-benefits-it-provides"><i class="fa fa-check"></i><b>10.1</b> A quick reminder of Bayes Theorem and the benefits it provides</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="datafusion.html"><a href="datafusion.html#the-benefits-of-bayes"><i class="fa fa-check"></i><b>10.1.1</b> The benefits of Bayes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="datafusion.html"><a href="datafusion.html#data-fusion"><i class="fa fa-check"></i><b>10.2</b> Data fusion</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="datafusion.html"><a href="datafusion.html#model-layers"><i class="fa fa-check"></i><b>10.2.1</b> Model layers</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="datafusion.html"><a href="datafusion.html#propogating-and-quantifying-uncertainty-using-mcmc"><i class="fa fa-check"></i><b>10.3</b> Propogating and quantifying uncertainty using MCMC</a></li>
<li class="chapter" data-level="10.4" data-path="datafusion.html"><a href="datafusion.html#completing-the-forecast-cycle"><i class="fa fa-check"></i><b>10.4</b> Completing the forecast cycle</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/jslingsby/BIO3019S_Ecoforecasting" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Introduction to Ecological Forecasting and Reproducible Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datafusion" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Data Fusion and Assimilation</h1>
<p>This lecture builds on section <a href="bayesian.html#bayesian">9</a>, “Going Bayesian,” with a focus on how a Bayesian framework allows us to:</p>
<ol style="list-style-type: decimal">
<li><strong><em>Fuse</em></strong> multiple sources of data that vary in their spatial or temporal scale, uncertainty, gaps, etc into our models, and</li>
<li><strong><em>Assimilate</em></strong> the previous forecast and new observations so that we can update our forecasts for the next iteration</li>
</ol>
<p>Along the way I’ll also discuss <strong>propogating and quantifying uncertainty</strong> in a Bayesian model using MCMC, because it’s important for the narrative, but we’ll go into uncertainty in more detail in section <a href="#uncertainty"><strong>??</strong></a>.</p>
<p><br></p>
<div id="a-quick-reminder-of-bayes-theorem-and-the-benefits-it-provides" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> A quick reminder of Bayes Theorem and the benefits it provides</h2>
<p><span class="math display">\[
\underbrace{p(\theta|D)}_\text{posterior} \; \propto \; \underbrace{p(D|\theta)}_\text{likelihood} \;\; \underbrace{p(\theta)}_\text{prior} \;
\]</span>
Where the <strong><em>posterior</em></strong> is a probability distribution representing the credibility of the parameter values <span class="math inline">\(\theta\)</span>, taking the data, <span class="math inline">\(D\)</span>, into account.</p>
<p>The <strong><em>likelihood</em></strong>, <span class="math inline">\(p(D|\theta)\)</span> represents the probability that the data could be generated by the model with parameter values <span class="math inline">\(\theta\)</span>. The likelihood of the parameters are maximized by choosing the parameters that maximize the probability of the data.</p>
<p>The <strong><em>prior</em></strong> probability distribution is the marginal probability of the parameters, <span class="math inline">\(p(\theta)\)</span>, and represents the credibility of the parameter values, <span class="math inline">\(\theta\)</span>, without the data, <span class="math inline">\(D\)</span>. Since <strong><em>it must not</em></strong> be inferred from the data, it is specified using our <strong>prior belief</strong> of what the parameters should be, before interrogating the data. Prior information can be sourced from previous analyses (of other data!), literature, meta-analyses, expert opinion or ecological theory. We need to be very careful about how we specify our priors so as not to bias the analysis!</p>
<p><br></p>
<div id="the-benefits-of-bayes" class="section level3" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> The benefits of Bayes</h3>
<ol style="list-style-type: decimal">
<li>They are <strong>focused on estimating what properties are</strong> (i.e. the actual values of particular parameters) and not null hypothesis testing</li>
<li>They are highly <strong>flexible</strong>, allowing one to build relatively <strong>complex models with varied data sources</strong> (and/or of varying quality), especially Hierarchical Bayesian models</li>
</ol>
<ul>
<li>This is important for <strong><em>Data Fusion</em></strong> that we’ll discuss today</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>They can easily treat all terms as probability distributions, making it <strong>easier to quantify, propagate, partition and represent uncertainties throughout the analysis probabilistically</strong>.</li>
</ol>
<ul>
<li>Which we’ll touch on today, but is the focus of section <a href="#uncertainty"><strong>??</strong></a> (our next lecture).</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>They provide an <strong>iterative</strong> probabilistic framework that makes it easier to update predictions as new data become available, mirroring the scientific method and completing the forecasting cycle.</li>
</ol>
<ul>
<li>This closing of the forecast loop is termed <strong><em>Data Assimilation</em></strong> and we’ll discuss it towards the end of the lecture.</li>
</ul>
<p><br></p>
</div>
</div>
<div id="data-fusion" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Data fusion</h2>
<p>Here we’ll revisit the Fynbos postfire recovery model we played with in the practical to highlight:</p>
<ul>
<li>including varied data sources</li>
<li>using priors to borrow strength across your data (by using Hierarchical Bayes and hyperpriors)</li>
<li>gap filling</li>
</ul>
<p>To illustrate all this we should quickly revisit how our model structure has changed as we’ve moved from Least Squares to Maximum Likelihood Estimation to “single-level” Bayes to Hierarchical Bayes.</p>
<p><br></p>
<div id="model-layers" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Model layers</h3>
<p><strong><em>Least Squares</em></strong></p>
<p>The method of <strong>Least Squares</strong> makes no explicit distinction between the <strong>process model</strong> (that models the drivers determining the pattern observed) and the <strong>data model</strong> (that models the observation error or data observation process, i.e. the factors that may cause mismatch between the process model and the data). This is because we require homogeneity of variance in order to minimize the sums of squares, so the data model can only ever be a <strong>normal distribution</strong>.</p>
<p>Looking back at the practical, what this means is that for the Nonlinear Least Squares all we fitted was the process model, which for our simpler negative exponential model not including the seasonality term:</p>
<p><span class="math display">\[\begin{gather}
  \text{NDVI}_{i,t}=\alpha_i+\gamma_i\Big(1-e^{-\frac{age_{i,t}}{\lambda_i}}\Big)
\end{gather}\]</span></p>
<p><br></p>
<p><strong><em>Maximum Likelihood</em></strong></p>
<p>MLE does make a distinction between the <strong>data model</strong> and the <strong>process model</strong>, like so:</p>
<div class="figure" style="text-align: center"><span id="fig:mlelayers"></span>
<img src="img/MLElayers.png" alt="Maximum Likelihood makes a distinction between the process and data models." width="50%" />
<p class="caption">
Figure 10.1: Maximum Likelihood makes a distinction between the process and data models.
</p>
</div>
<p><br></p>
<p>I didn’t make the distinction in the equations presented in the practical, but we did in the functions we wrote, where we included the <strong>data model</strong>:</p>
<p><span class="math display">\[\begin{gather}
NDVI_{i,t}\sim\mathcal{N}(\mu_{i,t},\frac{1}{\sqrt{\tau}}) \\
\end{gather}\]</span></p>
<p>which is a Gaussian (normal) distribution, just like the NLS analysis, and was included as part of the the likelihood function, and separated from the function for the <strong>process model</strong>:</p>
<p><span class="math display">\[\begin{gather}  
\mu_{i,t}=\alpha_i+\gamma_i\Big(1-e^{-\frac{age_{i,t}}{\lambda_i}}\Big)\\
\end{gather}\]</span></p>
<p>Where <span class="math inline">\(\mu\)</span> is now the mean of the process model, not accounting for the residual error described by the data model - similar to the open circles in Figure <a href="#fig:leastsquares2"><strong>??</strong></a>.</p>
<p><br></p>
<p><strong><em>Single-level Bayes</em></strong></p>
<p>When we use Bayesian models we now have the <strong>priors</strong>, which are essentially models describing our prior expectation for each of the parameters in the process model, like so:</p>
<div class="figure" style="text-align: center"><span id="fig:bayeslayers"></span>
<img src="img/bayeslayers.png" alt="Bayesian models include an additional layer; parameter models that describe our prior expectation for the parameters in the process." width="50%" />
<p class="caption">
Figure 10.2: Bayesian models include an additional layer; parameter models that describe our prior expectation for the parameters in the process.
</p>
</div>
<p><br></p>
<p>When implementing Bayesian models, we just specify the priors as <strong>parameter models</strong>, e.g.:</p>
<p><span class="math display">\[\begin{gather}
\alpha_i\sim\mathcal{N}(\mu_{\alpha},\frac{1}{\sqrt{\tau_{\alpha}}})\\
\gamma_i\sim\mathcal{N}(\mu_{\gamma},\frac{1}{\sqrt{\tau_{\gamma}}})\\
\lambda_i\sim\mathcal{N}(\mu_{\lambda},\frac{1}{\sqrt{\tau_{\lambda}}})\\
\end{gather}\]</span></p>
<p>Where (in this case) we believe they are all sampled from normal distributions with means <span class="math inline">\(\mu\)</span> and standard deviations <span class="math inline">\(\tau\)</span>.</p>
<p>Note that you need priors (i.e. parameter models) for all parameters.</p>
<p><br></p>
<p><strong><em>Hierarchical Bayes</em></strong></p>
<ul>
<li>The value of priors and HB for Data Fusion with post-fire recovery as an example?</li>
</ul>
<p><br></p>
<p><span class="math display">\[\begin{gather}  
\mu_{i,t}=\alpha_i+\gamma_i\Big(1-e^{-\frac{age_{i,t}}{\lambda_i}}\Big)+
      A_i\times sin\Big(2\pi\times age_{i,t}+\Big[\phi+\frac{\pi}{6}(m_{i,t}-1)\Big]\Big) \\
\end{gather}\]</span></p>
<p><br></p>
</div>
</div>
<div id="propogating-and-quantifying-uncertainty-using-mcmc" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Propogating and quantifying uncertainty using MCMC</h2>
<p><strong><em>Move to next lecture!!!</em></strong></p>
<p>Moncrieff et al example</p>
<p><br></p>
</div>
<div id="completing-the-forecast-cycle" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Completing the forecast cycle</h2>
<ul>
<li>Revisiting the forecast cycle… (forecast vs analysis step) - Ch13.1
<ul>
<li>Forecast step is just propagating the uncertainty in our variable(s) of interest into the future…</li>
<li>Analysis step is combining our prior knowledge with the new data
<ul>
<li>This is better than just using the new data, because
<ul>
<li>it uses our prior information and understanding</li>
<li>there is likely error (noise) in the data</li>
<li>somewhat similar to borrowing strength across your data in space in the postfire example, but in time?</li>
<li>if the forecast is uncertain and the data precise then the data will prevail</li>
<li>if the forecast is precise and the data uncertain, then we retain the legacy of previous observations</li>
</ul></li>
</ul></li>
<li>There are a number of methods for achieving these steps, but they come with trade-offs between their assumptions and computational efficiency, with MCMC being the most flexible (i.e. least assumptions), but computationally taxing because it is a numerical solution. More efficient analytical methods (e.g. Kalman filter) have many limitations and assumptions (e.g. linear, normal only).</li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jslingsby/BIO3019S_Ecoforecasting/edit/master/08-datafusion.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIO3019S Ecoforecasting.pdf", "BIO3019S Ecoforecasting.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
